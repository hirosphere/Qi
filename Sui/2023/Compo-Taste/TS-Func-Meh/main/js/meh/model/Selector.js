import { Leaf } from "./Leaf.js";
const log = console.log;
export class Selector {
    current;
    refs = new Map;
    constructor() {
        const rel = (newV, oldV) => this.update(newV, oldV);
        this.current = new Leaf(null, { rel });
    }
    makeRef(value) {
        if (!this.refs.has(value.__ru)) {
            this.refs.set(value.__ru, new Ref(this, value));
        }
        return this.refs.get(value.__ru);
    }
    update(newV, oldV) {
        oldV && this.makeRef(oldV)?.selected.set(false);
        newV && this.makeRef(newV)?.selected.set(true);
    }
}
class Ref {
    selector;
    value;
    selected = new Leaf.Boolean(false);
    constructor(selector, value) {
        this.selector = selector;
        this.value = value;
    }
    select() {
        log(this.value);
        this.selector.current.value = this.value;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2VsZWN0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi90cy1zcmMvbWVoL21vZGVsL1NlbGVjdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDakMsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQztBQUV4QixNQUFNLE9BQU8sUUFBUTtJQUVKLE9BQU8sQ0FBQztJQUVMLElBQUksR0FBRyxJQUFJLEdBQXlCLENBQUM7SUFFeEQ7UUFFQyxNQUFNLEdBQUcsR0FBRyxDQUFFLElBQWUsRUFBRSxJQUFpQixFQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFFLElBQUksRUFBRSxJQUFJLENBQUUsQ0FBQztRQUVoRixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFnQixJQUFJLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBRSxDQUFDO0lBQ3hELENBQUM7SUFFRCxPQUFPLENBQUUsS0FBUztRQUVqQixJQUFJLENBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUUsS0FBSyxDQUFDLElBQUksQ0FBRSxFQUNqQztZQUNDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFFLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUUsSUFBSSxFQUFFLEtBQUssQ0FBRSxDQUFFLENBQUM7U0FDcEQ7UUFDRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFFLEtBQUssQ0FBQyxJQUFJLENBQUUsQ0FBQztJQUNwQyxDQUFDO0lBRVMsTUFBTSxDQUFFLElBQWUsRUFBRSxJQUFpQjtRQUVuRCxJQUFJLElBQU0sSUFBSSxDQUFDLE9BQU8sQ0FBRSxJQUFJLENBQUcsRUFBRSxRQUFRLENBQUMsR0FBRyxDQUFFLEtBQUssQ0FBRSxDQUFDO1FBQ3ZELElBQUksSUFBTSxJQUFJLENBQUMsT0FBTyxDQUFFLElBQUksQ0FBRyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUUsSUFBSSxDQUFFLENBQUM7SUFDdkQsQ0FBQztDQUNEO0FBRUQsTUFBTSxHQUFHO0lBTVk7SUFDSDtJQUxELFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUUsS0FBSyxDQUFFLENBQUM7SUFFckQsWUFFb0IsUUFBeUIsRUFDNUIsS0FBUztRQUROLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBQzVCLFVBQUssR0FBTCxLQUFLLENBQUk7SUFFekIsQ0FBQztJQUVGLE1BQU07UUFFTCxHQUFHLENBQUUsSUFBSSxDQUFDLEtBQUssQ0FBRSxDQUFDO1FBQ2xCLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQzFDLENBQUM7Q0FDRCJ9