import { Leaf } from "../../meh/index.js";
export class Pitch extends Leaf.Number {
    freq;
    note;
    constructor() {
        const rel = () => this.update();
        super(69, { rel });
        this.freq = new Leaf.String("");
        this.note = new Leaf.String("A4");
        rel();
    }
    update() {
        const { freq, keyname } = ptol(this.value, 440);
        this.freq.value = r(freq);
        this.note.value = keyname;
    }
}
const ptol = (pitch, tune = 440) => {
    const key = Math.round(pitch);
    const oct = Math.floor(key / 12) - 1;
    const frac = pitch - key;
    const kni = (key >= 0 ? key % 12 : 12 + (key % 12));
    const keyname = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B", "C"][kni] + oct;
    const freq = tune * Math.pow(2, (pitch - 69) / 12);
    return { keyname, oct, frac, freq };
};
const r = (v, s = 1) => String(Math.round(v * s) / s);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmYtbW9kZWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vdHMtc3JjL2FwcHMvVkYvdmYtbW9kZWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUUxQyxNQUFNLE9BQU8sS0FBTSxTQUFRLElBQUksQ0FBQyxNQUFNO0lBRXJDLElBQUksQ0FBQztJQUFDLElBQUksQ0FBQztJQUVYO1FBRUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBRWhDLEtBQUssQ0FBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBRSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFFLEVBQUUsQ0FBRSxDQUFDO1FBQ2xDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFFLElBQUksQ0FBRSxDQUFDO1FBRXBDLEdBQUcsRUFBRSxDQUFDO0lBQ1AsQ0FBQztJQUVELE1BQU07UUFFTCxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBRSxJQUFJLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBRSxDQUFDO1FBRWxELElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBRSxJQUFJLENBQUUsQ0FBQztRQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUM7SUFDM0IsQ0FBQztDQUNEO0FBRUQsTUFBTSxJQUFJLEdBQUcsQ0FBRSxLQUFjLEVBQUUsSUFBSSxHQUFHLEdBQUcsRUFBRyxFQUFFO0lBRTdDLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUUsS0FBSyxDQUFFLENBQUM7SUFDaEMsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBRSxHQUFHLEdBQUcsRUFBRSxDQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ3ZDLE1BQU0sSUFBSSxHQUFHLEtBQUssR0FBRyxHQUFHLENBQUM7SUFDekIsTUFBTSxHQUFHLEdBQUcsQ0FBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBRSxHQUFHLEdBQUcsRUFBRSxDQUFFLENBQUUsQ0FBQztJQUN4RCxNQUFNLE9BQU8sR0FBRyxDQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUcsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFHLEdBQUcsQ0FBRSxDQUFHLEdBQUcsQ0FBRSxHQUFHLEdBQUcsQ0FBQztJQUUxRyxNQUFNLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBRSxDQUFDLEVBQUUsQ0FBRSxLQUFLLEdBQUcsRUFBRSxDQUFFLEdBQUcsRUFBRSxDQUFFLENBQUM7SUFFdkQsT0FBTyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDO0FBQ3JDLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxHQUFHLENBQUUsQ0FBVSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBRSxJQUFJLENBQUMsS0FBSyxDQUFFLENBQUMsR0FBRyxDQUFDLENBQUUsR0FBRyxDQUFDLENBQUUsQ0FBQyJ9