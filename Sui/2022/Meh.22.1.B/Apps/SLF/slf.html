<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>SLF</title>

<style>

* { box-sizing: border-box; margin: 0; padding: 0; }

html
{
	height: 100vh;
	background: linear-gradient( 180deg, hsl( 0, 0%, 100% ) 0%, hsl( 30, 40%, 85% ) 100% );
	display: flex;
	justify-content: center;
}

body
{
	width: 700px; height: 100%; background: hsl( 0, 0%, 100% );
	padding: 1em 2em;
}

.v-flex-ct { display: flex; flex-direction: column;  }

.App { gap: 1em; }

.Range
{
	display: grid;
	grid-template-columns: 5em 400px 7ex 2ex;
}
.Range .value { margin-left: 1ex; text-align: right; }
.Range .unit { margin-left: 0.2ex; color:hsl( 30, 0%, 25% ); font-size: 97%; }

</style>

</head>
<body class="v-flex-ct">
	
<script type="module">

import Meh from "../../Meh/meh.js";
const { HTDOM, Range, Leaf, Sound } = Meh;

class SLFModel
{
	volume = new Leaf.Number( 30 );
	freq = new Leaf.Number( 40 );
}

const CtrlA = args =>
{
	const { model } = args;

	return {
		type: "div", class: "Ranges",
		parts:[
			{ type: Range, title: "音量", unit: "%", model: model.volume, min: 0, max: 100, step: 1, },
			{ type: Range, title: "周波数", unit: "Hz", model: model.freq, min: 0, max: 300, step: 0.1, },
		]
	};
};

const SGen = args =>
{
	const { model } = args;

	const def =
	{
		type: "gain",
		params: { gain: [ model.volume, v => v == 0 ? 0 : Math.pow( 2, v / 10 ) - 10 ] },
		parts:
		{
			osc1: { type: "noise" },
		},
		conns:
		[
			[ "osc1", "main" ],
		]
	};
	return def;
};

const App = args =>
{
	const model = new SLFModel;

	const sound = Sound.create( { type: SGen, model } );

	return {
		type: "div", class: "App v-flex-ct",
		parts:[
			{ type: "h1", text: "SLF" },
			{ type: CtrlA, model },
		]
	};
};

HTDOM.create( { type: App }, "body" );

</script>


</body>
</html>