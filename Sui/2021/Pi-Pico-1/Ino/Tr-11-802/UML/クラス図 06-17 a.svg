<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="807px" preserveAspectRatio="none" style="width:702px;height:807px;background:#FFFFFF;" version="1.1" viewBox="0 0 702 807" width="702px" zoomAndPan="magnify"><defs><filter height="300%" id="f16y208ootdejq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[335f4d9be48430461c68bf6d6fdba145]
class App--><rect codeLine="1" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="99.2188" id="App" style="stroke:#333333;stroke-width:1.5;" width="148" x="366.5" y="7"/><ellipse cx="424.25" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M426.5938,18.6719 C425.6563,18.2344 425.0625,18.0938 424.1875,18.0938 C421.5625,18.0938 419.5625,20.1719 419.5625,22.8906 L419.5625,24.0156 C419.5625,26.5938 421.6719,28.4844 424.5625,28.4844 C425.7813,28.4844 426.9375,28.1875 427.6875,27.6406 C428.2656,27.2344 428.5938,26.7813 428.5938,26.3906 C428.5938,25.9375 428.2031,25.5469 427.7344,25.5469 C427.5156,25.5469 427.3125,25.625 427.125,25.8125 C426.6719,26.2969 426.6719,26.2969 426.4844,26.3906 C426.0625,26.6563 425.375,26.7813 424.6094,26.7813 C422.5625,26.7813 421.2656,25.6875 421.2656,23.9844 L421.2656,22.8906 C421.2656,21.1094 422.5156,19.7969 424.25,19.7969 C424.8281,19.7969 425.4375,19.9531 425.9063,20.2031 C426.3906,20.4844 426.5625,20.7031 426.6563,21.1094 C426.7188,21.5156 426.75,21.6406 426.8906,21.7656 C427.0313,21.9063 427.2656,22.0156 427.4844,22.0156 C427.75,22.0156 428.0156,21.875 428.1875,21.6563 C428.2969,21.5 428.3281,21.3125 428.3281,20.8906 L428.3281,19.4688 C428.3281,19.0313 428.3125,18.9063 428.2188,18.75 C428.0625,18.4844 427.7813,18.3438 427.4844,18.3438 C427.1875,18.3438 426.9844,18.4375 426.7656,18.75 L426.5938,18.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="444.75" y="27.1543">App</text><line style="stroke:#333333;stroke-width:1.5;" x1="367.5" x2="513.5" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="372.5" y="53.2104">trains : Train[]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="372.5" y="66.0151">canvas : Canvas</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="135" x="372.5" y="78.8198">powers :PowerChannels</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="136" x="372.5" y="91.6245">usb_mon : SerialMonitor</text><line style="stroke:#333333;stroke-width:1.5;" x1="367.5" x2="513.5" y1="98.2188" y2="98.2188"/><!--MD5=[ff74e0f0bb3fa51f8c743cb54bdb5b13]
class Train--><rect codeLine="9" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="166.4375" id="Train" style="stroke:#333333;stroke-width:1.5;" width="132" x="174.5" y="183"/><ellipse cx="221.75" cy="199" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M224.0938,194.6719 C223.1563,194.2344 222.5625,194.0938 221.6875,194.0938 C219.0625,194.0938 217.0625,196.1719 217.0625,198.8906 L217.0625,200.0156 C217.0625,202.5938 219.1719,204.4844 222.0625,204.4844 C223.2813,204.4844 224.4375,204.1875 225.1875,203.6406 C225.7656,203.2344 226.0938,202.7813 226.0938,202.3906 C226.0938,201.9375 225.7031,201.5469 225.2344,201.5469 C225.0156,201.5469 224.8125,201.625 224.625,201.8125 C224.1719,202.2969 224.1719,202.2969 223.9844,202.3906 C223.5625,202.6563 222.875,202.7813 222.1094,202.7813 C220.0625,202.7813 218.7656,201.6875 218.7656,199.9844 L218.7656,198.8906 C218.7656,197.1094 220.0156,195.7969 221.75,195.7969 C222.3281,195.7969 222.9375,195.9531 223.4063,196.2031 C223.8906,196.4844 224.0625,196.7031 224.1563,197.1094 C224.2188,197.5156 224.25,197.6406 224.3906,197.7656 C224.5313,197.9063 224.7656,198.0156 224.9844,198.0156 C225.25,198.0156 225.5156,197.875 225.6875,197.6563 C225.7969,197.5 225.8281,197.3125 225.8281,196.8906 L225.8281,195.4688 C225.8281,195.0313 225.8125,194.9063 225.7188,194.75 C225.5625,194.4844 225.2813,194.3438 224.9844,194.3438 C224.6875,194.3438 224.4844,194.4375 224.2656,194.75 L224.0938,194.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="29" x="242.25" y="203.1543">Train</text><line style="stroke:#333333;stroke-width:1.5;" x1="175.5" x2="305.5" y1="215" y2="215"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="180.5" y="229.2104">Target : Float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="56" x="180.5" y="242.0151">Act : Float</text><line style="stroke:#333333;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="175.5" x2="305.5" y1="248.6094" y2="248.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="76" x="180.5" y="262.8198">Speed : Float</text><line style="stroke:#333333;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="175.5" x2="305.5" y1="269.4141" y2="269.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="61" x="180.5" y="283.6245">Max : Float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="62" x="180.5" y="296.4292">Bias : Float</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="59" x="180.5" y="309.2339">Idle : Float</text><line style="stroke:#333333;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="175.5" x2="305.5" y1="315.8281" y2="315.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="120" x="180.5" y="330.0386">wavegs : WaveGen[]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="117" x="180.5" y="342.8433">cur_wg : WaveGen *</text><!--MD5=[4945c737fad898a5ce312252f730d528]
class Renderer--><rect codeLine="24" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="60.8047" id="Renderer" style="stroke:#333333;stroke-width:1.5;" width="189" x="231" y="540.5"/><ellipse cx="293.75" cy="556.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M294.7031,553.2813 L296.4219,553.2813 C296.8125,553.2813 297,553.25 297.125,553.1719 C297.3906,553.0156 297.5313,552.7344 297.5313,552.4375 C297.5313,552.1719 297.4219,551.9063 297.1875,551.7344 C297.0156,551.625 296.875,551.5938 296.4219,551.5938 L291.2813,551.5938 C290.8438,551.5938 290.7188,551.6094 290.5625,551.7031 C290.3125,551.8594 290.1563,552.1563 290.1563,552.4375 C290.1563,552.7188 290.2969,552.9688 290.5156,553.1406 C290.6719,553.25 290.8594,553.2813 291.2813,553.2813 L293,553.2813 L293,559.7969 L291.2813,559.7969 C290.8438,559.7969 290.7188,559.8125 290.5625,559.9219 C290.3125,560.0781 290.1563,560.3594 290.1563,560.6563 C290.1563,560.9063 290.2969,561.1719 290.5156,561.3281 C290.6719,561.4531 290.875,561.5 291.2813,561.5 L296.4219,561.5 C297.1719,561.5 297.5313,561.2188 297.5313,560.6563 C297.5313,560.375 297.4219,560.125 297.1875,559.9531 C297.0156,559.8281 296.875,559.7969 296.4219,559.7969 L294.7031,559.7969 L294.7031,553.2813 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="314.25" y="560.6543">Renderer</text><line style="stroke:#333333;stroke-width:1.5;" x1="232" x2="419" y1="572.5" y2="572.5"/><line style="stroke:#333333;stroke-width:1.5;" x1="232" x2="419" y1="580.5" y2="580.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="237" y="594.7104">Render( uint32_t * output, len )</text><!--MD5=[d3eb6627fe732eb9977ad27d5b914cb8]
class WaveGen--><rect codeLine="29" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="73.6094" id="WaveGen" style="stroke:#333333;stroke-width:1.5;" width="189" x="7" y="534"/><ellipse cx="68.25" cy="550" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M70.5938,545.6719 C69.6563,545.2344 69.0625,545.0938 68.1875,545.0938 C65.5625,545.0938 63.5625,547.1719 63.5625,549.8906 L63.5625,551.0156 C63.5625,553.5938 65.6719,555.4844 68.5625,555.4844 C69.7813,555.4844 70.9375,555.1875 71.6875,554.6406 C72.2656,554.2344 72.5938,553.7813 72.5938,553.3906 C72.5938,552.9375 72.2031,552.5469 71.7344,552.5469 C71.5156,552.5469 71.3125,552.625 71.125,552.8125 C70.6719,553.2969 70.6719,553.2969 70.4844,553.3906 C70.0625,553.6563 69.375,553.7813 68.6094,553.7813 C66.5625,553.7813 65.2656,552.6875 65.2656,550.9844 L65.2656,549.8906 C65.2656,548.1094 66.5156,546.7969 68.25,546.7969 C68.8281,546.7969 69.4375,546.9531 69.9063,547.2031 C70.3906,547.4844 70.5625,547.7031 70.6563,548.1094 C70.7188,548.5156 70.75,548.6406 70.8906,548.7656 C71.0313,548.9063 71.2656,549.0156 71.4844,549.0156 C71.75,549.0156 72.0156,548.875 72.1875,548.6563 C72.2969,548.5 72.3281,548.3125 72.3281,547.8906 L72.3281,546.4688 C72.3281,546.0313 72.3125,545.9063 72.2188,545.75 C72.0625,545.4844 71.7813,545.3438 71.4844,545.3438 C71.1875,545.3438 70.9844,545.4375 70.7656,545.75 L70.5938,545.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="88.75" y="554.1543">WaveGen</text><line style="stroke:#333333;stroke-width:1.5;" x1="8" x2="195" y1="566" y2="566"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="77" x="13" y="580.2104">train : Train &amp;</text><line style="stroke:#333333;stroke-width:1.5;" x1="8" x2="195" y1="586.8047" y2="586.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="177" x="13" y="601.0151">Render( uint32_t * output, len )</text><!--MD5=[5edf34eb39d3b3dfde6419c044ab889f]
class Canvas--><rect codeLine="35" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="112.0234" id="Canvas" style="stroke:#333333;stroke-width:1.5;" width="197" x="342" y="210"/><ellipse cx="414.75" cy="226" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M417.0938,221.6719 C416.1563,221.2344 415.5625,221.0938 414.6875,221.0938 C412.0625,221.0938 410.0625,223.1719 410.0625,225.8906 L410.0625,227.0156 C410.0625,229.5938 412.1719,231.4844 415.0625,231.4844 C416.2813,231.4844 417.4375,231.1875 418.1875,230.6406 C418.7656,230.2344 419.0938,229.7813 419.0938,229.3906 C419.0938,228.9375 418.7031,228.5469 418.2344,228.5469 C418.0156,228.5469 417.8125,228.625 417.625,228.8125 C417.1719,229.2969 417.1719,229.2969 416.9844,229.3906 C416.5625,229.6563 415.875,229.7813 415.1094,229.7813 C413.0625,229.7813 411.7656,228.6875 411.7656,226.9844 L411.7656,225.8906 C411.7656,224.1094 413.0156,222.7969 414.75,222.7969 C415.3281,222.7969 415.9375,222.9531 416.4063,223.2031 C416.8906,223.4844 417.0625,223.7031 417.1563,224.1094 C417.2188,224.5156 417.25,224.6406 417.3906,224.7656 C417.5313,224.9063 417.7656,225.0156 417.9844,225.0156 C418.25,225.0156 418.5156,224.875 418.6875,224.6563 C418.7969,224.5 418.8281,224.3125 418.8281,223.8906 L418.8281,222.4688 C418.8281,222.0313 418.8125,221.9063 418.7188,221.75 C418.5625,221.4844 418.2813,221.3438 417.9844,221.3438 C417.6875,221.3438 417.4844,221.4375 417.2656,221.75 L417.0938,221.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="43" x="435.25" y="230.1543">Canvas</text><line style="stroke:#333333;stroke-width:1.5;" x1="343" x2="538" y1="242" y2="242"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="84" x="348" y="256.2104">Render() : void</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="155" x="348" y="269.0151">renderers : Renderer[ cch ]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="348" y="281.8198">channels : Canvas::Cannel[ cch ]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="111" x="348" y="294.6245">GetBufferPair( cch )</text><line style="stroke:#333333;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="343" x2="538" y1="301.2188" y2="301.2188"/><polygon fill="none" points="353,307.2188,357,311.2188,353,315.2188,349,311.2188" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="92" x="362" y="315.4292">cur_index : 0 / 1</text><!--MD5=[322f9b768a43649b3e6f58181ae7856f]
class CanvasChannel--><rect codeLine="45" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="73.6094" id="CanvasChannel" style="stroke:#333333;stroke-width:1.5;" width="153" x="273" y="694.5"/><ellipse cx="301.95" cy="710.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M304.2938,706.1719 C303.3563,705.7344 302.7625,705.5938 301.8875,705.5938 C299.2625,705.5938 297.2625,707.6719 297.2625,710.3906 L297.2625,711.5156 C297.2625,714.0938 299.3719,715.9844 302.2625,715.9844 C303.4813,715.9844 304.6375,715.6875 305.3875,715.1406 C305.9656,714.7344 306.2938,714.2813 306.2938,713.8906 C306.2938,713.4375 305.9031,713.0469 305.4344,713.0469 C305.2156,713.0469 305.0125,713.125 304.825,713.3125 C304.3719,713.7969 304.3719,713.7969 304.1844,713.8906 C303.7625,714.1563 303.075,714.2813 302.3094,714.2813 C300.2625,714.2813 298.9656,713.1875 298.9656,711.4844 L298.9656,710.3906 C298.9656,708.6094 300.2156,707.2969 301.95,707.2969 C302.5281,707.2969 303.1375,707.4531 303.6063,707.7031 C304.0906,707.9844 304.2625,708.2031 304.3563,708.6094 C304.4188,709.0156 304.45,709.1406 304.5906,709.2656 C304.7313,709.4063 304.9656,709.5156 305.1844,709.5156 C305.45,709.5156 305.7156,709.375 305.8875,709.1563 C305.9969,709 306.0281,708.8125 306.0281,708.3906 L306.0281,706.9688 C306.0281,706.5313 306.0125,706.4063 305.9188,706.25 C305.7625,705.9844 305.4813,705.8438 305.1844,705.8438 C304.8875,705.8438 304.6844,705.9375 304.4656,706.25 L304.2938,706.1719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="90" x="319.05" y="714.6543">CanvasChannel</text><line style="stroke:#333333;stroke-width:1.5;" x1="274" x2="425" y1="726.5" y2="726.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="141" x="279" y="740.7104">buffs : uint32_t[ 2 ][ len ]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="279" y="753.5151">length</text><line style="stroke:#333333;stroke-width:1.5;" x1="274" x2="425" y1="760.1094" y2="760.1094"/><!--MD5=[c02275b4b1678e63f768634ee5a95dc6]
class PowerChannels--><rect codeLine="52" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="124.8281" id="PowerChannels" style="stroke:#333333;stroke-width:1.5;" width="191" x="497" y="379"/><ellipse cx="542.75" cy="395" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M545.0938,390.6719 C544.1563,390.2344 543.5625,390.0938 542.6875,390.0938 C540.0625,390.0938 538.0625,392.1719 538.0625,394.8906 L538.0625,396.0156 C538.0625,398.5938 540.1719,400.4844 543.0625,400.4844 C544.2813,400.4844 545.4375,400.1875 546.1875,399.6406 C546.7656,399.2344 547.0938,398.7813 547.0938,398.3906 C547.0938,397.9375 546.7031,397.5469 546.2344,397.5469 C546.0156,397.5469 545.8125,397.625 545.625,397.8125 C545.1719,398.2969 545.1719,398.2969 544.9844,398.3906 C544.5625,398.6563 543.875,398.7813 543.1094,398.7813 C541.0625,398.7813 539.7656,397.6875 539.7656,395.9844 L539.7656,394.8906 C539.7656,393.1094 541.0156,391.7969 542.75,391.7969 C543.3281,391.7969 543.9375,391.9531 544.4063,392.2031 C544.8906,392.4844 545.0625,392.7031 545.1563,393.1094 C545.2188,393.5156 545.25,393.6406 545.3906,393.7656 C545.5313,393.9063 545.7656,394.0156 545.9844,394.0156 C546.25,394.0156 546.5156,393.875 546.6875,393.6563 C546.7969,393.5 546.8281,393.3125 546.8281,392.8906 L546.8281,391.4688 C546.8281,391.0313 546.8125,390.9063 546.7188,390.75 C546.5625,390.4844 546.2813,390.3438 545.9844,390.3438 C545.6875,390.3438 545.4844,390.4375 545.2656,390.75 L545.0938,390.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="91" x="563.25" y="399.1543">PowerChannels</text><line style="stroke:#333333;stroke-width:1.5;" x1="498" x2="687" y1="411" y2="411"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="179" x="503" y="425.2104">channels : PowerChannel[ pch ]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="124" x="503" y="438.0151">slices_mask : uint32_t</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="117" x="503" y="450.8198">dma_mask : uint32_t</text><line style="stroke:#333333;stroke-width:1.5;" x1="498" x2="687" y1="457.4141" y2="457.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="147" x="503" y="471.6245">InitPeripheral( pch, pin_a )</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="141" x="503" y="484.4292">SetSource( pch, source )</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="503" y="497.2339">DMATrigger( cur_index )</text><!--MD5=[9fc26832ef69f22695faa49b5a7460a7]
class PowerChannel--><rect codeLine="63" fill="#E8F0FF" filter="url(#f16y208ootdejq)" height="124.8281" id="PowerChannel" style="stroke:#333333;stroke-width:1.5;" width="149" x="477" y="669"/><ellipse cx="506.85" cy="685" fill="#ADD1B2" rx="11" ry="11" style="stroke:#333333;stroke-width:1.0;"/><path d="M509.1938,680.6719 C508.2563,680.2344 507.6625,680.0938 506.7875,680.0938 C504.1625,680.0938 502.1625,682.1719 502.1625,684.8906 L502.1625,686.0156 C502.1625,688.5938 504.2719,690.4844 507.1625,690.4844 C508.3813,690.4844 509.5375,690.1875 510.2875,689.6406 C510.8656,689.2344 511.1938,688.7813 511.1938,688.3906 C511.1938,687.9375 510.8031,687.5469 510.3344,687.5469 C510.1156,687.5469 509.9125,687.625 509.725,687.8125 C509.2719,688.2969 509.2719,688.2969 509.0844,688.3906 C508.6625,688.6563 507.975,688.7813 507.2094,688.7813 C505.1625,688.7813 503.8656,687.6875 503.8656,685.9844 L503.8656,684.8906 C503.8656,683.1094 505.1156,681.7969 506.85,681.7969 C507.4281,681.7969 508.0375,681.9531 508.5063,682.2031 C508.9906,682.4844 509.1625,682.7031 509.2563,683.1094 C509.3188,683.5156 509.35,683.6406 509.4906,683.7656 C509.6313,683.9063 509.8656,684.0156 510.0844,684.0156 C510.35,684.0156 510.6156,683.875 510.7875,683.6563 C510.8969,683.5 510.9281,683.3125 510.9281,682.8906 L510.9281,681.4688 C510.9281,681.0313 510.9125,680.9063 510.8188,680.75 C510.6625,680.4844 510.3813,680.3438 510.0844,680.3438 C509.7875,680.3438 509.5844,680.4375 509.3656,680.75 L509.1938,680.6719 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="524.15" y="689.1543">PowerChannel</text><line style="stroke:#333333;stroke-width:1.5;" x1="478" x2="625" y1="701" y2="701"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="483" y="715.2104">slice_num : uint32_t</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="100" x="483" y="728.0151">dma_ch : uint32_t</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="55" x="483" y="740.8198">pin_a : int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="483" y="753.6245">source : BufferPair</text><line style="stroke:#333333;stroke-width:1.5;" x1="478" x2="625" y1="760.2188" y2="760.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="133" x="483" y="774.4292">InitPeripheral( pin_a, .. )</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="137" x="483" y="787.2339">DMATrigger( cur_index )</text><!--MD5=[7da33fca328a06bb05436a941c4b8f0e]
reverse link App to Train--><path codeLine="74" d="M378.916,115.601 C371.964,122.412 365.035,129.315 358.5,136 C341.42,153.472 323.414,172.711 306.753,190.879 " fill="none" id="App-backto-Train" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="388.376,106.4,381.2859,107.7157,379.7735,114.7664,386.8636,113.4507,388.376,106.4" style="stroke:#8888CC;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="359.5" y="149.0669">Tick( time )</text><!--MD5=[3a207c16dc6fef6d239a9352f35c32b3]
reverse link App to Canvas--><path codeLine="75" d="M440.5,119.35 C440.5,148.039 440.5,181.867 440.5,209.697 " fill="none" id="App-backto-Canvas" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="440.5,106.15,436.5,112.15,440.5,118.15,444.5,112.15,440.5,106.15" style="stroke:#8888CC;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="441.5" y="149.0669">Render()</text><!--MD5=[196e56e9326967bf8ad3efa8adfa7275]
reverse link App to PowerChannels--><path codeLine="76" d="M507.701,115.411 C526.391,134.994 544.763,158.23 556.5,183 C585.976,245.208 593.109,324.678 594.059,378.769 " fill="none" id="App-backto-PowerChannels" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="498.528,106.1,499.8894,113.1814,506.9498,114.6483,505.5883,107.5669,498.528,106.1" style="stroke:#8888CC;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="539.5" y="149.0669">DMATrigger( cur_i )</text><!--MD5=[3ab80eb15472702395d1876f127e1685]
reverse link Canvas to CanvasChannel--><path codeLine="78" d="M453.95,335.35 C464.739,406.244 472.891,518.973 437.5,608 C424.779,639.999 401.908,671.447 382.67,694.4663 " fill="none" id="Canvas-backto-CanvasChannel" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="451.843,322.182,448.8415,328.7387,453.7394,334.0312,456.7409,327.4745,451.843,322.182" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[abdcba4f44d21c4e13672bbc8e32104e]
reverse link Canvas to Renderer--><path codeLine="79" d="M348.986,331.608 C335.382,345.582 323.321,361.491 315.5,379 C291.868,431.905 305.099,501.431 315.919,540.337 " fill="none" id="Canvas-backto-Renderer" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="358.618,322.247,351.5276,323.5611,350.0136,330.6114,357.1039,329.2974,358.618,322.247" style="stroke:#8888CC;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="316.5" y="446.0669">Render( buffer, len )</text><!--MD5=[a0346796b772d4853d26bfdfae33e205]
reverse link PowerChannels to PowerChannel--><path codeLine="80" d="M581.865,517.203 C575.158,564.317 566.601,624.426 560.281,668.819 " fill="none" id="PowerChannels-backto-PowerChannel" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="583.704,504.283,578.898,509.6591,582.0121,516.1631,586.8181,510.787,583.704,504.283" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[2f8d1320213a16e92fc7ecea5233c3f7]
link Train to Renderer--><path codeLine="82" d="M242.586,349.235 C246.211,396.125 254.973,455.104 275.5,504 C278.397,510.901 282.184,517.724 286.378,524.217 " fill="none" id="Train-to-Renderer" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="none" points="292.07,520.142,298.104,540.455,280.72,528.338,292.07,520.142" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[0d822c0c304b1f3a43eccc63f1ad00ff]
reverse link Train to WaveGen--><path codeLine="83" d="M197.254,361.27 C170.447,419.706 137.531,491.458 118.105,533.804 " fill="none" id="Train-backto-WaveGen" style="stroke:#8888CC;stroke-width:1.0;"/><polygon fill="#8888CC" points="202.701,349.396,196.5636,353.1819,197.6977,360.3032,203.8351,356.5174,202.701,349.396" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[d0bc7f437e240493602f77d274fa7e6b]
link Renderer to CanvasChannel--><path codeLine="85" d="M330.014,601.813 C333.76,626.548 339.125,661.981 343.278,689.407 " fill="none" id="Renderer-to-CanvasChannel" style="stroke:#8888CC;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#8888CC" points="344.038,694.4301,346.643,684.932,343.2881,689.4867,338.7335,686.1318,344.038,694.4301" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[7ae50894655f3a82a6d1803281a3d505]
link WaveGen to CanvasChannel--><path codeLine="86" d="M158.085,608.164 C197.12,633.112 248.961,666.244 288.847,691.736 " fill="none" id="WaveGen-to-CanvasChannel" style="stroke:#8888CC;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#8888CC" points="293.158,694.4909,287.7291,686.2734,288.9451,691.798,283.4205,693.014,293.158,694.4909" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[90447d49975730a257f1442c1704339b]
link CanvasChannel to PowerChannel--><path codeLine="87" d="M426.039,731.5 C441.156,731.5 456.274,731.5 471.391,731.5 " fill="none" id="CanvasChannel-to-PowerChannel" style="stroke:#8888CC;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#8888CC" points="476.517,731.5,467.517,727.5,471.517,731.5,467.517,735.5,476.517,731.5" style="stroke:#8888CC;stroke-width:1.0;"/><!--MD5=[e5305fb6ac477f49d35d4df0fcd413a8]
@startuml
class App
{
    trains : Train[]
    canvas : Canvas
    powers :PowerChannels
    usb_mon : SerialMonitor
}

class Train
{
    Target : Float
    Act : Float
..
    Speed : Float
..
    Max : Float
    Bias : Float
    Idle : Float
..
    wavegs : WaveGen[]
    cur_wg : WaveGen *
}

interface Renderer
{
    Render( uint32_t * output, len )
}

class WaveGen
{
    train : Train &
    Render( uint32_t * output, len )
}

class Canvas
{
    Render() : void
    renderers : Renderer[ cch ]
    channels : Canvas::Cannel[ cch ]
    GetBufferPair( cch )
..
    # cur_index : 0 / 1
}

class CanvasChannel
{
    buffs : uint32_t[ 2 ][ len ]
    length
    
}

class PowerChannels
{
    channels : PowerChannel[ pch ]
    slices_mask : uint32_t
    dma_mask : uint32_t

    InitPeripheral( pch, pin_a )
    SetSource( pch, source )
    DMATrigger( cur_index )
}

class PowerChannel
{
    slice_num : uint32_t
    dma_ch : uint32_t
    pin_a : int
    source : BufferPair
    
    InitPeripheral( pin_a, .. )
    DMATrigger( cur_index )
}

App *- - Train : Tick( time )
App *- - Canvas : Render()
App *- - PowerChannels : DMATrigger( cur_i )

Canvas *- - CanvasChannel
Canvas *- - Renderer : Render( buffer, len )
PowerChannels *- - PowerChannel

Train - -|> Renderer
Train *- - WaveGen

Renderer .> CanvasChannel
WaveGen ..> CanvasChannel
CanvasChannel .> PowerChannel

skinparam class {
    BackgroundColor  #e8f0ff
    BorderColor  #333
    ArrowColor  #88c
}
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>